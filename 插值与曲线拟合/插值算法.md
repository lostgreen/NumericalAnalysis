# 插值算法

## 插值算法的缘由

### 现实问题

- 实验观测得到了一组离散的数据，存在关系函数$y = f(x)$，但是不知道具体形式
- 函数解析表达式已知，但是计算复杂不便于使用

### 插值方法

简单来说，插值就是根据所给的离散函数表，构造一个简单的连续函数$g(x)$(逼近函数/插值函数)来作为$f(x)$ (被逼近函数/被插值函数)替代

除了插值方法构造$g(x)$，还有一致逼近，最佳均方逼近和数据拟合法。

**Problem I**: 已知函数 \( y = f(x) \) 的函数表

**插值区间**：

| X | \( x_0 \) | \( x_1 \) | ... | \( x_n \) |
|---|---|---|---|---|
| y | \( y_0 \) | \( y_1 \) | ... | \( y_n \) |

- \( x_i \)（\( i = 0, 1, \ldots, n \)）两两互异，\( x_i \in [a, b] \)。
- 求次数不超过 \( n \) 的多项式：

\[ P_n(x) = a_0 + a_1 x + a_2 x^2 + \ldots + a_n x^n \]

- 使得 \( P_n(x_i) = y_i \)，\( i = 0, 1, \ldots, n \)（插值条件）。

**插值条件**：

- \( n + 1 \) 个互异点 \( x_0, x_1, \ldots, x_n \) 称为插值节点。
- 其所在区间 \([a, b]\) 为插值区间。
- \( P_n(x_i) = y_i \) 为插值条件。

### 定理

在 \( n+1 \) 个互异的插值结点 \( x_0, x_1, \ldots, x_n \) 上满足插值条件(2.2)的次数不超过 \( n \) 的代数多项式 \( P_n(x) \) 存在且唯一。

#### 证明

由插值条件，有：

\[
\left\{
\begin{array}{l}
P_n(x_0) = a_0 + a_1 x_0 + a_2 x_0^2 + \ldots + a_n x_0^n = y_0 \\
P_n(x_1) = a_0 + a_1 x_1 + a_2 x_1^2 + \ldots + a_n x_1^n = y_1 \\
\vdots \\
P_n(x_n) = a_0 + a_1 x_n + a_2 x_n^2 + \ldots + a_n x_n^n = y_n \\
\end{array}
\right.
\]

其系数矩阵的行列式为：

\[
\left|
\begin{array}{llll}
1 & x_0 & x_0^2 & \ldots & x_0^n \\
1 & x_1 & x_1^2 & \ldots & x_1^n \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
1 & x_n & x_n^2 & \ldots & x_n^n \\
\end{array}
\right| = V_n(x_0, x_1, \ldots, x_n) = \prod_{i=1}^n \prod_{j=0}^{i-1} (x_i - x_j) \neq 0
\]

因此，方程组的解 \( a_0, a_1, \ldots, a_n \) 存在且唯一。

\(\therefore\) 插值多项式存在且唯一。

#### 例题

给定 \( f(x) \) 的函数表，求 \( f(x) \) 的次数不超过3的插值多项式。

| X | -1 | 1 | 2 | 5 |
|---|----|---|---|---|
| y | -7 | 7 | 4 | 35 |

解：设 \( P_3(x) = a_0 + a_1 x + a_2 x^2 + a_3 x^3 \)，则

\[
\left\{
\begin{array}{l}
-7 = a_0 - a_1 + a_2 - a_3 \\
7 = a_0 + a_1 + a_2 + a_3 \\
4 = a_0 + 2a_1 + 4a_2 + 8a_3 \\
35 = a_0 + 5a_1 + 10a_2 + 25a_3 \\
\end{array}
\right.
\]

解方程组得 \( a_0 = 10, a_1 = 5, a_2 = -10, a_3 = 2 \)。

即 \( P_3(x) = 10 + 5x - 10x^2 + 2x^3 \)。

**注**：这里我们采用线性代数的**克莱默法则**进行解方程组
克莱默法则指出，对于一个线性方程组：

\[
\left\{
\begin{array}{l}
a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n = b_1 \\
a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n = b_2 \\
\vdots \\
a_{n1}x_1 + a_{n2}x_2 + \cdots + a_{nn}x_n = b_n \\
\end{array}
\right.
\]

每个未知数 \( x_i \) 的解可以表示为：

\[
x_i = \frac{\Delta_i}{\Delta}
\]

其中，\( \Delta \) 是系数矩阵的行列式，\( \Delta_i \) 是将系数矩阵的第 \( i \) 列替换为常数列向量 \( b_1, b_2, \ldots, b_n \) 后得到的矩阵的行列式。

对于这个的方程组：

\[
\left\{
\begin{array}{l}
-7 = a_0 - a_1 + a_2 - a_3 \\
7 = a_0 + a_1 + a_2 + a_3 \\
4 = a_0 + 2a_1 + 4a_2 + 8a_3 \\
35 = a_0 + 5a_1 + 10a_2 + 25a_3 \\
\end{array}
\right.
\]

我们可以写出每个未知数 \( a_i \) 的克莱默表示：

1. 对于 \( a_0 \)：

\[
a_0 = \frac{\Delta_0}{\Delta}
\]

其中，\( \Delta \) 是：

\[
\Delta = \left| \begin{array}{cccc}
1 & 1 & 1 & 1 \\
-1 & 1 & 1 & -1 \\
1 & 2 & 4 & 8 \\
-1 & 5 & 10 & 25 \\
\end{array} \right|
\]

\( \Delta_0 \) 是将 \( \Delta \) 的第一列替换为常数列向量 \(-7, 7, 4, 35\) 后得到的行列式：

\[
\Delta_0 = \left| \begin{array}{cccc}
-7 & 1 & 1 & 1 \\
7 & 1 & 1 & -1 \\
4 & 2 & 4 & 8 \\
35 & 5 & 10 & 25 \\
\end{array} \right|
\]

2. 对于 \( a_1 \)：

\[
a_1 = \frac{\Delta_1}{\Delta}
\]

\( \Delta_1 \) 是将 \( \Delta \) 的第二列替换为常数列向量 \(-7, 7, 4, 35\) 后得到的行列式：

\[
\Delta_1 = \left| \begin{array}{cccc}
1 & -7 & 1 & 1 \\
-1 & 7 & 1 & -1 \\
1 & 4 & 4 & 8 \\
-1 & 35 & 10 & 25 \\
\end{array} \right|
\]

3. 对于 \( a_2 \)：

\[
a_2 = \frac{\Delta_2}{\Delta}
\]

\( \Delta_2 \) 是将 \( \Delta \) 的第三列替换为常数列向量 \(-7, 7, 4, 35\) 后得到的行列式：

\[
\Delta_2 = \left| \begin{array}{cccc}
1 & 1 & -7 & 1 \\
-1 & 1 & 7 & -1 \\
1 & 2 & 4 & 8 \\
-1 & 5 & 35 & 25 \\
\end{array} \right|
\]

4. 对于 \( a_3 \)：

\[
a_3 = \frac{\Delta_3}{\Delta}
\]

\( \Delta_3 \) 是将 \( \Delta \) 的第四列替换为常数列向量 \(-7, 7, 4, 35\) 后得到的行列式：

\[
\Delta_3 = \left| \begin{array}{cccc}
1 & 1 & 1 & -7 \\
-1 & 1 & 1 & 7 \\
1 & 2 & 4 & 4 \\
-1 & 5 & 10 & 35 \\
\end{array} \right|
\]

这些行列式的计算将给出 \( a_0, a_1, a_2, a_3 \) 的值。

**注**：接着，我们对这样求解的复杂度进行分析：对于一个 \( n \) 个未知数的 \( n \) 个线性方程组，克莱默法则的复杂度分析如下：

1. **计算系数矩阵的行列式（\( \Delta \)）**：
   - 系数矩阵是一个 \( n \times n \) 的矩阵，计算其行列式的复杂度是 \( O(n!) \)，即随着 \( n \) 的增加，计算复杂度呈阶乘增长。对于较大的 \( n \)，这是一个非常耗时的操作。

2. **计算每个未知数的行列式（\( \Delta_i \)）**：
   - 对于每个未知数 \( a_i \)，需要计算一个 \( n \times n \) 的行列式，其复杂度是 \( O(n!) \)。由于有 \( n \) 个未知数，所以这一步的总复杂度是 \( O(n \cdot n!) \)。

3. **求解每个未知数**：
   - 每个未知数 \( a_i \) 的解由 \( a_i = \frac{\Delta_i}{\Delta} \) 给出。这个步骤本身计算量不大，但是需要对每个未知数重复进行。

综合以上步骤，克莱默法则求解 \( n \) 个未知数的 \( n \) 个线性方程组的总体复杂度是 \( O(n \cdot n!) \)。这意味着随着方程组规模的增加，计算复杂度会非常迅速地增长。

对于大规模的方程组，克莱默法则的计算复杂度是不可接受的，因为它的计算量随着方程组规模的增加呈指数级增长。这就是为什么在实际应用中，对于大规模的线性方程组，我们通常使用其他更高效的算法，如高斯消元法（Gaussian Elimination）或LU分解等，这些方法的复杂度通常是 \( O(n^3) \) 或更低，对于大规模问题来说更加实用。

### 线性插值

给定两个点 \((x_0, y_0)\) 和 \((x_1, y_1)\)，我们可以通过这两点作一条直线 \(y = P_1(x)\) 来进行线性插值。

#### 插值公式

\[
P_1(x) = y_0 + \frac{y_1 - y_0}{x_1 - x_0}(x - x_0)
\]

这个公式可以分解为两部分，以展示基函数的形式：

\[
P_1(x) = y_0 \cdot l_0(x) + y_1 \cdot l_1(x)
\]

其中，\(l_0(x)\) 和 \(l_1(x)\) 是线性插值基函数，定义如下：

\[
l_0(x) = \frac{x - x_1}{x_0 - x_1}, \quad l_1(x) = \frac{x - x_0}{x_1 - x_0}
\]

#### 基函数的作用

- \(l_0(x)\) 和 \(l_1(x)\) 称为线性插值基函数，它们在区间 \([x_0, x_1]\) 内分别与 \(x\) 轴和直线 \(P_1(x)\) 形成面积相等的三角形。
- \(P_1(x)\) 是这两个基函数的线性组合，表示通过点 \((x_0, y_0)\) 和 \((x_1, y_1)\) 的直线。

### 抛物插值

已知 \( y = f(x) \) 的函数表，\( x_0, x_1, x_2 \) 为互异节点，求一个次数不超过 2 的多项式：

\[
P_2(x) = a_0 + a_1 x + a_2 x^2
\]

使得：

\[
P_2(x_0) = y_0, \quad P_2(x_1) = y_1, \quad P_2(x_2) = y_2
\]

#### 几何意义

\( P_2(x) \) 为过三点 \( (x_0, y_0), (x_1, y_1), (x_2, y_2) \) 的抛物线。

#### 方法：基函数法

构造基函数 \( I_0(x), I_1(x), I_2(x) \)（三个二次式），使：

\[
P_2(x) = y_0 l_0(x) + y_1 l_1(x) + y_2 l_2(x)
\]

满足插值条件：

\[
\begin{align*}
& l_0(x_0) = 1, \quad l_0(x_1) = 0, \quad l_0(x_2) = 0 \\
& l_1(x_0) = 0, \quad l_1(x_1) = 1, \quad l_1(x_2) = 0 \\
& l_2(x_0) = 0, \quad l_2(x_1) = 0, \quad l_2(x_2) = 1 \\
\end{align*}
\]

其中 \( l_i(x_j) = \delta_{ij} \)，\( i, j = 0, 1, 2 \)。

这些基函数 \( l_0(x), l_1(x), l_2(x) \) 被称为拉格朗日基函数，它们在插值点处的值为1，在其他插值点处的值为0。

根据给定条件：

\[
I_0(x_0) = 1, \quad I_0(x_1) = 0, \quad I_0(x_2) = 0
\]

可以表示为：

\[
I_0(x) = C(x - x_1)(x - x_2)
\]

由 \( I_0(x_0) = 1 \) 得：

\[
C(x_0 - x_1)(x_0 - x_2) = 1 \implies C = \frac{1}{(x_0 - x_1)(x_0 - x_2)}
\]

因此：

\[
l_0(x) = \frac{(x - x_1)(x - x_2)}{(x_0 - x_1)(x_0 - x_2)}
\]

#### 同理求 \( I_1(x) \) 和 \( I_2(x) \)

\[
l_1(x) = \frac{(x - x_0)(x - x_2)}{(x_1 - x_0)(x_1 - x_2)}
\]

\[
l_2(x) = \frac{(x - x_0)(x - x_1)}{(x_2 - x_0)(x_2 - x_1)}
\]

#### 抛物插值问题的解

\[
P_2(x) = y_0 l_0(x) + y_1 l_1(x) + y_2 l_2(x)
\]

代入 \( l_0(x), l_1(x), l_2(x) \) 得：

\[
P_2(x) = y_0 \frac{(x - x_1)(x - x_2)}{(x_0 - x_1)(x_0 - x_2)} + y_1 \frac{(x - x_0)(x - x_2)}{(x_1 - x_0)(x_1 - x_2)} + y_2 \frac{(x - x_0)(x - x_1)}{(x_2 - x_0)(x_2 - x_1)}
\]

### Lagrange插值公式

已知 \( y = f(x) \) 在两两互异节点 \( x_0, x_1, \ldots, x_n \) 的函数值 \( y_0, y_1, \ldots, y_n \)，求 \( n \) 次多项式：

\[
P_n(x) = a_0 + a_1 x + a_2 x^2 + \ldots + a_n x^n
\]

满足插值条件：

\[
P_n(x_j) = y_j, \quad j = 0, 1, 2, \ldots, n
\]

#### 基函数法

求 \( n+1 \) 个 \( n \) 次多项式 \( I_0(x), I_1(x), \ldots, I_n(x) \)，使：

\[
P_n(x) = y_0 l_0(x) + y_1 l_1(x) + \ldots + y_n l_n(x)
\]

其中，\( P_n(x) \) 须满足插值条件：

\[
P_n(x_j) = y_j, \quad j = 0, 1, 2, \ldots, n
\]

并且：

\[
\begin{gathered}
l_0(x_j) = 0, \quad l_1(x_j) = 0, \quad \ldots, \quad l_j(x_j) = 1, \quad \ldots, \quad l_n(x_j) = 0 \\
j = 0, 1, 2, \ldots, n
\end{gathered}
\]

这可以表示为：

\[
l_k(x_j) = \delta_{kj} = \begin{cases}
1 & \text{if } k = j \\
0 & \text{if } k \neq j
\end{cases}
\]

其中，\( \delta_{kj} \) 是克罗内克函数，当 \( k = j \) 时为1，否则为0。

#### 拉格朗日基函数的一般形式

根据前两个例子类比一下，每个拉格朗日基函数 \( l_k(x) \) 可以表示为：

\[
l_k(x) = \prod_{\substack{0 \leq j \leq n \\ j \neq k}} \frac{x - x_j}{x_k - x_j}
\]

这个公式确保了 \( l_k(x_j) = \delta_{kj} \)，即除了 \( x = x_k \) 时 \( l_k(x) = 1 \)，其他所有插值节点处 \( l_k(x) = 0 \)。

### 插值余项

#### 插值性质

1. \( P_n(x_i) = f(x_i) = y_i \)，\( i = 0, 1, 2, \ldots, n \)
2. 对于插值区间 \([a, b]\) 内插值节点 \( x_i \)（\( i = 1, 2, \ldots, n \)）以外的点 \( x \)，一般 \( P_n(x) \neq f(x) \)，存在误差。

#### 截断误差或插值余项

定义 \( R_n(x) = f(x) - P_n(x) \) 为 \( P_n(x) \) 的截断误差或插值余项。

1. \( R_n(x_i) = 0 \)，\( i = 0, 1, 2, \ldots, n \)
2. 若 \( x \neq x_i \)，可能 \( R_n(x) \neq 0 \)

利用 Lagrange插值公式 \( P_n(x) \) 来计算的结果是否可靠，在于余项 \( R_n(x) \) 是否足够小。

#### 截断误差的表达式

\[
R_n(x) = f(x) - P_n(x)
\]

给定 \( a \leq x_0 < x_1 < \cdots < x_n \leq b \)，且 \( f \) 满足条件 \( f \in C^n[a, b] \)，\( f^{(n+1)} \) 在 \([a, b]\) 内存在，考察截断误差 \( R_n(x) = f(x) - P_n(x) \)。

根据表达形式可以得出，\( R_n(x) \) 至少有 \( n+1 \) 个根 \( x_0, x_1, \ldots, x_n \)。
因此，\( R_n(x) = K(x) \prod_{i=0}^n (x - x_i) \)。

任意固定 \( x \neq x_i \)（\( i = 0, \ldots, n \)），考察 \( \varphi(t) = R_n(t) - K(x) \prod_{i=0}^n (t - x_i) \)。

- \( \varphi(t) \) 有 \( n+2 \) 个不同的根 \( x_0, \ldots, x_n, x \)。
- 因此，\( \varphi^{(n+1)}(\xi_x) = 0 \)，\( \xi_x \in (a, b) \)（不断利用罗尔定理）。

由此可得：

\[
R_n^{(n+1)}(\xi_x) - K(x)(n+1)! = 0
\]

\[
f^{(n+1)}(\xi_x) - P_n^{(n+1)}(\xi_x) - K(x)(n+1)! = 0
\]（根据函数表，P是常数，求导为0）

\[
K(x) = \frac{f^{(n+1)}(\xi_x)}{(n+1)!}
\]

因此，截断误差 \( R_n(x) \) 可以表示为：

\[
R_n(x) = \frac{f^{(n+1)}(\xi_x)}{(n+1)!} \prod_{i=0}^n (x - x_i)
\]

这个公式给出了拉格朗日插值多项式的截断误差的表达式，其中 \( \xi_x \) 是区间 \((a, b)\) 内的某一点，\( f^{(n+1)}(\xi_x) \) 是 \( f \) 在 \( \xi_x \) 处的 \( (n+1) \) 阶导数。

### 计算 \( \lg(2.718) \) 并估计其误差

已知 \( y = \lg(x) \) 的函数表如下：

| X       | 2.71 | 2.72 | 2.73 |
|---------|------|------|------|
| \( \lg(x) \) | 0.4330 | 0.4346 | 0.4362 |

#### 解：

使用拉格朗日插值多项式 \( P_2(x) \)：

\[
P_2(x) = 0.4330 \frac{(x - 2.72)(x - 2.73)}{(2.71 - 2.72)(2.71 - 2.73)} + 0.4346 \frac{(x - 2.71)(x - 2.73)}{(2.72 - 2.71)(2.72 - 2.73)} + 0.4362 \frac{(x - 2.71)(x - 2.72)}{(2.73 - 2.71)(2.73 - 2.72)}
\]

化简得：

\[
P_2(x) = 13038 x^2 - 7092.08 x + 96459.032
\]

因此，\( \lg(2.718) \approx P_2(2.718) = 0.48 \)。

#### 误差估计：

截断误差 \( R_2(x) \) 为：

\[
R_2(x) = \frac{f^{(3)}(\xi)}{3!} (x - x_0)(x - x_1)(x - x_2) \quad \xi \in (x_0, x_2)
\]

由于 \( f(x) = \lg x \)，我们有：

\[
f^{(3)}(x) = \frac{2}{x^3 \ln 10}
\]

在区间 \([2.71, 2.73]\) 上，\( |f^{(3)}(x)| \) 的最大值为 \( 0.043642 \)。

因此，误差的绝对值不超过：

\[
|R_2(2.718)| \leq \frac{0.043642}{6} |(2.718 - 2.71)(2.718 - 2.72)(2.718 - 2.73)| = 1.39654 \times 10^{-9}
\]
